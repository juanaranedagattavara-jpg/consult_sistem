---
phase: 01-foundation-auth-onboarding
plan: 06
type: execute
wave: 4
depends_on: ["01-04", "01-05"]
files_modified: [src/app/layout.tsx, src/app/ConvexClientProvider.tsx]
autonomous: true
must_haves:
  truths:
    - "App renders with Convex and theme providers"
  artifacts:
    - path: "src/app/ConvexClientProvider.tsx"
      contains: "ConvexProvider"
    - path: "src/app/layout.tsx"
      contains: "ThemeProvider"
---

<objective>
Create root layout with Convex, theme, and toast providers.

Purpose: App-wide providers for state, auth, and UI.
Output: Root layout wrapping entire app with necessary providers.
</objective>

<tasks>

<task type="auto">
  <name>Create providers and root layout</name>
  <files>src/app/ConvexClientProvider.tsx, src/app/layout.tsx</files>
  <action>
  1. Create src/app/ConvexClientProvider.tsx:
  ```typescript
  "use client";

  import { ConvexProvider, ConvexReactClient } from "convex/react";
  import { ConvexAuthProvider } from "@convex-dev/auth/react";
  import { ReactNode } from "react";

  const convex = new ConvexReactClient(process.env.NEXT_PUBLIC_CONVEX_URL!);

  export function ConvexClientProvider({ children }: { children: ReactNode }) {
    return (
      <ConvexAuthProvider client={convex}>
        {children}
      </ConvexAuthProvider>
    );
  }
  ```

  2. Update src/app/layout.tsx:
  ```typescript
  import type { Metadata } from "next";
  import { Inter } from "next/font/google";
  import "./globals.css";
  import { ConvexClientProvider } from "./ConvexClientProvider";
  import { ThemeProvider } from "next-themes";
  import { Toaster } from "sonner";

  const inter = Inter({ subsets: ["latin"] });

  export const metadata: Metadata = {
    title: "ConsultSystem",
    description: "Sistema de agendamiento para cl√≠nicas",
  };

  export default function RootLayout({
    children,
  }: {
    children: React.ReactNode;
  }) {
    return (
      <html lang="es" suppressHydrationWarning>
        <body className={inter.className}>
          <ThemeProvider attribute="class" defaultTheme="light">
            <ConvexClientProvider>
              {children}
              <Toaster richColors position="top-right" />
            </ConvexClientProvider>
          </ThemeProvider>
        </body>
      </html>
    );
  }
  ```

  3. Add NEXT_PUBLIC_CONVEX_URL to .env.local (from Convex dashboard)
  </action>
  <verify>npm run dev shows app with providers working</verify>
  <done>Root layout configured with all providers</done>
</task>

</tasks>

<verification>
- [ ] ConvexClientProvider.tsx exists
- [ ] layout.tsx has all providers
- [ ] App renders without errors
- [ ] Toaster shows test notification
</verification>

<success_criteria>
- All providers configured
- App renders successfully
- No hydration errors
</success_criteria>

<output>
Create `.planning/phases/01-foundation-auth-onboarding/01-06-SUMMARY.md`
</output>
