---
phase: 02-professionals-services-calendar
plan: 21
type: execute
wave: 6
depends_on: ["02-06"]
files_modified:
  - src/components/professionals/professional-cards.tsx
autonomous: true

must_haves:
  truths:
    - "Cards show photo/initial, name, specialty, color"
    - "Shows calendar connection status"
    - "Toggle active/inactive on card"
    - "Edit action available"
  artifacts:
    - path: "src/components/professionals/professional-cards.tsx"
      provides: "Card grid view of professionals"
      exports: ["ProfessionalCards"]
  key_links:
    - from: "src/components/professionals/professional-cards.tsx"
      to: "convex/professionals.ts"
      via: "useQuery"
      pattern: "professionals.list"
---

<objective>
Create professionals cards component for alternative view.

Purpose: Admin can view professionals as cards instead of table - more visual with avatar/initial and specialty.
Output: ProfessionalCards component with grid layout and card UI.
</objective>

<execution_context>
@C:\Users\juana\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\juana\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-professionals-services-calendar/CONTEXT.md
@convex/professionals.ts
@src/components/ui/card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create professional cards component</name>
  <files>src/components/professionals/professional-cards.tsx</files>
  <action>
Create src/components/professionals/professional-cards.tsx:

```tsx
"use client";

import { useQuery, useMutation } from "convex/react";
import { api } from "@/convex/_generated/api";
import { Id } from "@/convex/_generated/dataModel";
import { toast } from "sonner";
import { Calendar, Pencil, User } from "lucide-react";

import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Switch } from "@/components/ui/switch";
import { Card, CardContent } from "@/components/ui/card";

interface ProfessionalCardsProps {
  clinicId: Id<"clinics">;
  onEdit: (professionalId: Id<"professionals">) => void;
  filter?: "all" | "active" | "inactive";
}

export function ProfessionalCards({
  clinicId,
  onEdit,
  filter = "all",
}: ProfessionalCardsProps) {
  const professionals = useQuery(api.professionals.listWithServices, { clinicId });
  const toggleActive = useMutation(api.professionals.toggleActive);

  // Filter professionals
  const filtered = professionals?.filter((p) => {
    if (filter === "active") return p.active;
    if (filter === "inactive") return !p.active;
    return true;
  }) ?? [];

  async function handleToggle(professionalId: Id<"professionals">) {
    try {
      await toggleActive({ professionalId });
    } catch (error) {
      toast.error("Error al cambiar estado");
    }
  }

  if (!professionals) {
    return <div className="text-center py-8 text-muted-foreground">Cargando...</div>;
  }

  if (filtered.length === 0) {
    return (
      <div className="text-center py-12 text-muted-foreground">
        <User className="h-12 w-12 mx-auto mb-4 opacity-50" />
        <p>No hay profesionales</p>
        <p className="text-sm mt-1">
          {filter !== "all" ? "Prueba cambiando el filtro" : "Crea un profesional para empezar"}
        </p>
      </div>
    );
  }

  return (
    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
      {filtered.map((professional) => (
        <Card
          key={professional._id}
          className={`relative overflow-hidden transition-all hover:shadow-md ${
            !professional.active ? "opacity-60" : ""
          }`}
        >
          {/* Color stripe at top */}
          <div
            className="h-2 w-full"
            style={{ backgroundColor: professional.color }}
          />

          <CardContent className="p-4">
            {/* Avatar/Initial */}
            <div className="flex items-start gap-4">
              <div
                className="w-14 h-14 rounded-full flex items-center justify-center text-white text-xl font-semibold shrink-0"
                style={{ backgroundColor: professional.color }}
              >
                {professional.name.charAt(0).toUpperCase()}
              </div>

              <div className="flex-1 min-w-0">
                <h3 className="font-semibold truncate">{professional.name}</h3>
                <p className="text-sm text-muted-foreground truncate">
                  {professional.specialty}
                </p>
                <p className="text-xs text-muted-foreground truncate mt-1">
                  {professional.email}
                </p>
              </div>
            </div>

            {/* Services */}
            <div className="mt-4 flex flex-wrap gap-1">
              {professional.services.slice(0, 3).map((s) => (
                <Badge key={s?._id} variant="secondary" className="text-xs">
                  {s?.name}
                </Badge>
              ))}
              {professional.services.length > 3 && (
                <Badge variant="secondary" className="text-xs">
                  +{professional.services.length - 3}
                </Badge>
              )}
            </div>

            {/* Footer */}
            <div className="mt-4 flex items-center justify-between">
              {/* Calendar Status */}
              <div>
                {professional.calendarId ? (
                  <Badge variant="outline" className="text-green-600 border-green-600 text-xs">
                    <Calendar className="h-3 w-3 mr-1" />
                    Calendar
                  </Badge>
                ) : (
                  <Badge variant="outline" className="text-muted-foreground text-xs">
                    Sin calendar
                  </Badge>
                )}
              </div>

              {/* Actions */}
              <div className="flex items-center gap-2">
                <Switch
                  checked={professional.active}
                  onCheckedChange={() => handleToggle(professional._id)}
                />
                <Button
                  variant="ghost"
                  size="icon"
                  onClick={() => onEdit(professional._id)}
                >
                  <Pencil className="h-4 w-4" />
                </Button>
              </div>
            </div>
          </CardContent>
        </Card>
      ))}
    </div>
  );
}
```

Key features:
- Grid layout responsive (1 col mobile, 2-4 cols desktop)
- Card with color stripe and avatar initial
- Shows name, specialty, email
- Service badges (max 3 + count)
- Calendar connection status badge
- Inline active toggle and edit button
- Dimmed when inactive
  </action>
  <verify>No TypeScript errors: `npx tsc --noEmit`</verify>
  <done>ProfessionalCards with grid layout and card UI</done>
</task>

</tasks>

<verification>
1. `cat src/components/professionals/professional-cards.tsx` shows component
2. `npx tsc --noEmit` succeeds
3. Cards show all required info from CONTEXT.md
</verification>

<success_criteria>
- Responsive grid layout (1-4 columns)
- Card shows initial in color circle
- Name, specialty, email displayed
- Service badges (max 3 visible)
- Calendar status badge
- Active toggle inline
- Edit button on each card
</success_criteria>

<output>
After completion, create `.planning/phases/02-professionals-services-calendar/02-21-SUMMARY.md`
</output>
