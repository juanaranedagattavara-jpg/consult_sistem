---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - tailwind.config.ts
  - convex/convex.config.ts
  - convex/_generated/
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/lib/utils.ts
  - components.json
  - .env.local
autonomous: true

must_haves:
  truths:
    - "Next.js dev server starts without errors"
    - "Convex dev server connects successfully"
    - "shadcn/ui components can be imported"
    - "Tailwind CSS classes apply correctly"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies"
      contains: "next, convex, @convex-dev/auth"
    - path: "convex/convex.config.ts"
      provides: "Convex configuration"
    - path: "src/app/layout.tsx"
      provides: "Root layout with providers"
    - path: "components.json"
      provides: "shadcn/ui configuration"
  key_links:
    - from: "src/app/layout.tsx"
      to: "ConvexProvider"
      via: "provider wrapping"
      pattern: "ConvexProvider"
---

<objective>
Initialize the Next.js 15 project with all core dependencies and configurations for the dental clinic dashboard.

Purpose: Establish the foundational project structure that all subsequent plans will build upon.
Output: A working Next.js + Convex + shadcn/ui project skeleton ready for feature development.
</objective>

<context>
Stack: Next.js 15 (App Router) + Convex + shadcn/ui + Tailwind CSS
This is the first plan - no prior context needed.

Key patterns from research:
- Use @convex-dev/auth for authentication
- Convex as backend (no separate API layer)
- shadcn/ui for component library
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Next.js 15 project with dependencies</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    tailwind.config.ts
    postcss.config.js
  </files>
  <action>
    1. Create Next.js 15 project in the current directory (prospector-local):
       - Use App Router (src/app directory)
       - TypeScript enabled
       - Tailwind CSS enabled
       - ESLint enabled

    2. Install core dependencies:
       ```bash
       npm install convex @convex-dev/auth
       npm install resend
       npm install zod
       ```

    3. Install shadcn/ui prerequisites (do NOT run shadcn init yet):
       ```bash
       npm install class-variance-authority clsx tailwind-merge
       npm install lucide-react
       npm install @radix-ui/react-slot
       ```

    4. Update tailwind.config.ts for shadcn compatibility:
       - Add CSS variable support for theming
       - Configure content paths for src/ and components/

    5. Create src/lib/utils.ts with cn() helper:
       ```typescript
       import { type ClassValue, clsx } from "clsx"
       import { twMerge } from "tailwind-merge"

       export function cn(...inputs: ClassValue[]) {
         return twMerge(clsx(inputs))
       }
       ```
  </action>
  <verify>
    - npm run dev starts without errors
    - package.json contains convex, @convex-dev/auth, resend
  </verify>
  <done>
    Next.js 15 project initialized with all dependencies installed and Tailwind configured
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Convex and shadcn/ui</name>
  <files>
    convex/convex.config.ts
    convex/tsconfig.json
    src/app/layout.tsx
    src/app/globals.css
    components.json
    .env.local
  </files>
  <action>
    1. Initialize Convex:
       ```bash
       npx convex dev --once
       ```
       This creates convex/ directory with _generated/ files

    2. Create convex/convex.config.ts (if not created):
       ```typescript
       import { defineConfig } from "convex/server";

       export default defineConfig({});
       ```

    3. Initialize shadcn/ui:
       ```bash
       npx shadcn@latest init
       ```
       Configuration choices:
       - Style: Default
       - Base color: Slate
       - CSS variables: Yes
       - tailwind.config location: tailwind.config.ts
       - Components location: src/components
       - Utils location: src/lib/utils
       - React Server Components: Yes

    4. Install initial shadcn components for auth:
       ```bash
       npx shadcn@latest add button card input label form tabs
       ```

    5. Create .env.local with placeholders:
       ```
       CONVEX_DEPLOYMENT=
       NEXT_PUBLIC_CONVEX_URL=
       RESEND_API_KEY=
       ```

    6. Update src/app/layout.tsx:
       - Import globals.css
       - Add ConvexClientProvider wrapper (create provider file)
       - Set up basic metadata

    7. Create src/components/providers/convex-provider.tsx:
       ```typescript
       "use client";

       import { ConvexProvider, ConvexReactClient } from "convex/react";
       import { ReactNode } from "react";

       const convex = new ConvexReactClient(process.env.NEXT_PUBLIC_CONVEX_URL!);

       export function ConvexClientProvider({ children }: { children: ReactNode }) {
         return <ConvexProvider client={convex}>{children}</ConvexProvider>;
       }
       ```
  </action>
  <verify>
    - npx convex dev connects without auth errors (may need to login)
    - shadcn components importable: import { Button } from "@/components/ui/button"
    - Layout renders with provider wrapper
  </verify>
  <done>
    Convex configured and connected, shadcn/ui initialized with base components, provider setup complete
  </done>
</task>

<task type="auto">
  <name>Task 3: Create base project structure</name>
  <files>
    src/app/page.tsx
    src/app/(auth)/layout.tsx
    src/app/(dashboard)/layout.tsx
    src/types/index.ts
  </files>
  <action>
    1. Create route group structure:
       - src/app/(auth)/ - for login, register, verify pages (no dashboard layout)
       - src/app/(dashboard)/ - for protected dashboard pages (with sidebar)

    2. Create minimal src/app/(auth)/layout.tsx:
       ```typescript
       export default function AuthLayout({ children }: { children: React.ReactNode }) {
         return (
           <div className="min-h-screen flex items-center justify-center bg-slate-50">
             {children}
           </div>
         );
       }
       ```

    3. Create placeholder src/app/(dashboard)/layout.tsx:
       ```typescript
       export default function DashboardLayout({ children }: { children: React.ReactNode }) {
         return (
           <div className="min-h-screen">
             {/* Sidebar will be added in plan 04 */}
             <main>{children}</main>
           </div>
         );
       }
       ```

    4. Update src/app/page.tsx to redirect or show landing:
       ```typescript
       import { redirect } from "next/navigation";

       export default function Home() {
         // Will redirect to dashboard or login based on auth state
         redirect("/login");
       }
       ```

    5. Create src/types/index.ts with basic type exports:
       ```typescript
       // Re-export types as they are created
       export type {};
       ```
  </action>
  <verify>
    - npm run dev shows the app without errors
    - Route groups created: (auth), (dashboard)
    - Navigating to / redirects to /login (will 404 until auth pages created)
  </verify>
  <done>
    Project structure established with route groups for auth and dashboard flows
  </done>
</task>

</tasks>

<verification>
1. Run `npm run dev` - Next.js starts on localhost:3000
2. Run `npx convex dev` - Convex connects to deployment
3. Check `package.json` contains: next, convex, @convex-dev/auth, resend, zod
4. Import test: Button from "@/components/ui/button" resolves
5. Tailwind classes apply (test with className="bg-blue-500")
</verification>

<success_criteria>
- Next.js 15 project running with App Router
- Convex initialized and connected to a deployment
- shadcn/ui configured with Button, Card, Input, Label, Form, Tabs components
- ConvexClientProvider wrapping the app
- Route groups (auth) and (dashboard) created
- .env.local with required environment variable placeholders
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
