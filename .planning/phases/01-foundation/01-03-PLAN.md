---
phase: 01-foundation
plan: 03
type: execute
wave: 2
depends_on: ["01-01", "01-02"]
files_modified:
  - src/app/(auth)/login/page.tsx
  - src/app/(auth)/register/page.tsx
  - src/app/(auth)/verify-email/page.tsx
  - src/app/(auth)/forgot-password/page.tsx
  - src/app/(auth)/reset-password/page.tsx
  - src/components/auth/login-form.tsx
  - src/components/auth/register-form.tsx
  - src/components/auth/verify-email-form.tsx
  - src/components/auth/forgot-password-form.tsx
  - src/hooks/use-auth.ts
autonomous: true

must_haves:
  truths:
    - "User sees login form at /login"
    - "User sees register form at /register with clinic fields"
    - "User can submit registration and gets redirected to verify email"
    - "User can enter 6-digit code to verify email"
    - "User can request password reset from login page"
    - "Invalid credentials show error message"
    - "Remember me checkbox is visible on login"
  artifacts:
    - path: "src/app/(auth)/login/page.tsx"
      provides: "Login page"
      min_lines: 20
    - path: "src/app/(auth)/register/page.tsx"
      provides: "Registration page"
      min_lines: 20
    - path: "src/components/auth/login-form.tsx"
      provides: "Login form with validation"
      contains: "useForm"
    - path: "src/components/auth/register-form.tsx"
      provides: "Register form with clinic fields"
      contains: "clinicName"
    - path: "src/hooks/use-auth.ts"
      provides: "Auth hook for components"
      exports: ["useAuth"]
  key_links:
    - from: "src/components/auth/login-form.tsx"
      to: "convex/auth"
      via: "signIn mutation"
      pattern: "signIn"
    - from: "src/components/auth/register-form.tsx"
      to: "convex/users.ts"
      via: "createUserProfile mutation"
      pattern: "createUserProfile"
---

<objective>
Build the complete authentication UI including login, registration with clinic setup, email verification, and password reset flows using shadcn/ui components.

Purpose: Provide user-facing interfaces for all authentication requirements (AUTH-01 through AUTH-04).
Output: Fully functional auth pages with forms, validation, and Convex integration.
</objective>

<context>
@.planning/phases/01-foundation/01-01-SUMMARY.md (for project structure)
@.planning/phases/01-foundation/01-02-SUMMARY.md (for auth backend functions)

Dependencies:
- shadcn/ui components: Button, Card, Input, Label, Form, Tabs
- Convex mutations: signIn, signOut, createUserProfile, createVerificationCode, verifyCode
- Convex queries: currentUser, isAuthenticated

Registration fields:
- Email (required)
- Password (required, 8+ chars, letter + number)
- Name (required)
- Clinic name (required)
- Phone (required)

Login options:
- "Remember me" checkbox (extends to 30 days)
- "Forgot password?" link
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create auth hook and shared components</name>
  <files>
    src/hooks/use-auth.ts
    src/components/auth/auth-card.tsx
    src/lib/validations/auth.ts
  </files>
  <action>
    1. Create src/hooks/use-auth.ts:
    ```typescript
    "use client";

    import { useQuery, useMutation } from "convex/react";
    import { api } from "../../convex/_generated/api";
    import { useAuthActions } from "@convex-dev/auth/react";
    import { useRouter } from "next/navigation";

    export function useAuth() {
      const router = useRouter();
      const { signIn, signOut } = useAuthActions();

      const user = useQuery(api.auth.currentUser);
      const isAuthenticated = useQuery(api.auth.isAuthenticated);

      const createProfile = useMutation(api.users.createUserProfile);
      const createVerificationCode = useMutation(api.emails.createVerificationCode);
      const verifyCode = useMutation(api.emails.verifyCode);

      const login = async (email: string, password: string, rememberMe: boolean) => {
        try {
          await signIn("password", {
            email,
            password,
            flow: "signIn",
          });
          // Handle session extension for rememberMe
          // Note: @convex-dev/auth handles session management
          router.push("/dashboard");
        } catch (error) {
          throw error;
        }
      };

      const register = async (data: {
        email: string;
        password: string;
        name: string;
        clinicName: string;
        clinicPhone: string;
      }) => {
        try {
          // First sign up with password provider
          await signIn("password", {
            email: data.email,
            password: data.password,
            flow: "signUp",
          });

          // Then create the profile and clinic
          await createProfile({
            name: data.name,
            clinicName: data.clinicName,
            clinicPhone: data.clinicPhone,
          });

          // Generate verification code
          await createVerificationCode({ type: "email" });

          router.push("/verify-email");
        } catch (error) {
          throw error;
        }
      };

      const logout = async () => {
        await signOut();
        router.push("/login");
      };

      const verifyEmail = async (code: string) => {
        await verifyCode({ code, type: "email" });
        router.push("/dashboard");
      };

      return {
        user,
        isAuthenticated,
        isLoading: user === undefined,
        login,
        register,
        logout,
        verifyEmail,
        createVerificationCode,
      };
    }
    ```

    2. Create src/components/auth/auth-card.tsx:
    ```typescript
    import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
    import { ReactNode } from "react";

    interface AuthCardProps {
      title: string;
      description?: string;
      children: ReactNode;
      footer?: ReactNode;
    }

    export function AuthCard({ title, description, children, footer }: AuthCardProps) {
      return (
        <Card className="w-full max-w-md">
          <CardHeader className="space-y-1">
            <CardTitle className="text-2xl font-bold">{title}</CardTitle>
            {description && (
              <CardDescription>{description}</CardDescription>
            )}
          </CardHeader>
          <CardContent>
            {children}
          </CardContent>
          {footer && (
            <div className="px-6 pb-6 pt-0">
              {footer}
            </div>
          )}
        </Card>
      );
    }
    ```

    3. Create src/lib/validations/auth.ts:
    ```typescript
    import { z } from "zod";

    export const loginSchema = z.object({
      email: z.string().email("Invalid email address"),
      password: z.string().min(1, "Password is required"),
      rememberMe: z.boolean().default(false),
    });

    export const registerSchema = z.object({
      email: z.string().email("Invalid email address"),
      password: z
        .string()
        .min(8, "Password must be at least 8 characters")
        .regex(/[a-zA-Z]/, "Password must contain at least one letter")
        .regex(/[0-9]/, "Password must contain at least one number"),
      name: z.string().min(2, "Name must be at least 2 characters"),
      clinicName: z.string().min(2, "Clinic name must be at least 2 characters"),
      clinicPhone: z.string().min(6, "Please enter a valid phone number"),
    });

    export const verifyEmailSchema = z.object({
      code: z.string().length(6, "Code must be 6 digits"),
    });

    export const forgotPasswordSchema = z.object({
      email: z.string().email("Invalid email address"),
    });

    export const resetPasswordSchema = z.object({
      code: z.string().length(6, "Code must be 6 digits"),
      password: z
        .string()
        .min(8, "Password must be at least 8 characters")
        .regex(/[a-zA-Z]/, "Password must contain at least one letter")
        .regex(/[0-9]/, "Password must contain at least one number"),
      confirmPassword: z.string(),
    }).refine((data) => data.password === data.confirmPassword, {
      message: "Passwords don't match",
      path: ["confirmPassword"],
    });

    export type LoginFormData = z.infer<typeof loginSchema>;
    export type RegisterFormData = z.infer<typeof registerSchema>;
    export type VerifyEmailFormData = z.infer<typeof verifyEmailSchema>;
    export type ForgotPasswordFormData = z.infer<typeof forgotPasswordSchema>;
    export type ResetPasswordFormData = z.infer<typeof resetPasswordSchema>;
    ```
  </action>
  <verify>
    - Files compile without TypeScript errors
    - Import paths resolve correctly
  </verify>
  <done>
    Auth hook with login/register/logout functions, auth card component, and Zod validation schemas created
  </done>
</task>

<task type="auto">
  <name>Task 2: Build login and register pages</name>
  <files>
    src/app/(auth)/login/page.tsx
    src/app/(auth)/register/page.tsx
    src/components/auth/login-form.tsx
    src/components/auth/register-form.tsx
  </files>
  <action>
    1. Create src/components/auth/login-form.tsx:
    ```typescript
    "use client";

    import { useState } from "react";
    import { useForm } from "react-hook-form";
    import { zodResolver } from "@hookform/resolvers/zod";
    import Link from "next/link";
    import { Button } from "@/components/ui/button";
    import { Input } from "@/components/ui/input";
    import { Label } from "@/components/ui/label";
    import { Checkbox } from "@/components/ui/checkbox";
    import { loginSchema, type LoginFormData } from "@/lib/validations/auth";
    import { useAuth } from "@/hooks/use-auth";

    export function LoginForm() {
      const [error, setError] = useState<string | null>(null);
      const [isLoading, setIsLoading] = useState(false);
      const { login } = useAuth();

      const form = useForm<LoginFormData>({
        resolver: zodResolver(loginSchema),
        defaultValues: {
          email: "",
          password: "",
          rememberMe: false,
        },
      });

      const onSubmit = async (data: LoginFormData) => {
        setError(null);
        setIsLoading(true);
        try {
          await login(data.email, data.password, data.rememberMe);
        } catch (err) {
          setError(err instanceof Error ? err.message : "Login failed");
        } finally {
          setIsLoading(false);
        }
      };

      return (
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-4">
          {error && (
            <div className="p-3 text-sm text-red-500 bg-red-50 border border-red-200 rounded-md">
              {error}
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="email">Email</Label>
            <Input
              id="email"
              type="email"
              placeholder="correo@clinica.com"
              {...form.register("email")}
            />
            {form.formState.errors.email && (
              <p className="text-sm text-red-500">{form.formState.errors.email.message}</p>
            )}
          </div>

          <div className="space-y-2">
            <Label htmlFor="password">Password</Label>
            <Input
              id="password"
              type="password"
              {...form.register("password")}
            />
            {form.formState.errors.password && (
              <p className="text-sm text-red-500">{form.formState.errors.password.message}</p>
            )}
          </div>

          <div className="flex items-center justify-between">
            <div className="flex items-center space-x-2">
              <Checkbox
                id="rememberMe"
                checked={form.watch("rememberMe")}
                onCheckedChange={(checked) =>
                  form.setValue("rememberMe", checked === true)
                }
              />
              <Label htmlFor="rememberMe" className="text-sm font-normal">
                Recordarme
              </Label>
            </div>
            <Link
              href="/forgot-password"
              className="text-sm text-primary hover:underline"
            >
              Olvidaste tu password?
            </Link>
          </div>

          <Button type="submit" className="w-full" disabled={isLoading}>
            {isLoading ? "Iniciando sesion..." : "Iniciar sesion"}
          </Button>

          <p className="text-center text-sm text-muted-foreground">
            No tienes cuenta?{" "}
            <Link href="/register" className="text-primary hover:underline">
              Registrate
            </Link>
          </p>
        </form>
      );
    }
    ```

    2. Create src/app/(auth)/login/page.tsx:
    ```typescript
    import { AuthCard } from "@/components/auth/auth-card";
    import { LoginForm } from "@/components/auth/login-form";

    export default function LoginPage() {
      return (
        <AuthCard
          title="Iniciar Sesion"
          description="Ingresa tus credenciales para acceder al dashboard"
        >
          <LoginForm />
        </AuthCard>
      );
    }
    ```

    3. Create src/components/auth/register-form.tsx:
    ```typescript
    "use client";

    import { useState } from "react";
    import { useForm } from "react-hook-form";
    import { zodResolver } from "@hookform/resolvers/zod";
    import Link from "next/link";
    import { Button } from "@/components/ui/button";
    import { Input } from "@/components/ui/input";
    import { Label } from "@/components/ui/label";
    import { registerSchema, type RegisterFormData } from "@/lib/validations/auth";
    import { useAuth } from "@/hooks/use-auth";

    export function RegisterForm() {
      const [error, setError] = useState<string | null>(null);
      const [isLoading, setIsLoading] = useState(false);
      const { register } = useAuth();

      const form = useForm<RegisterFormData>({
        resolver: zodResolver(registerSchema),
        defaultValues: {
          email: "",
          password: "",
          name: "",
          clinicName: "",
          clinicPhone: "",
        },
      });

      const onSubmit = async (data: RegisterFormData) => {
        setError(null);
        setIsLoading(true);
        try {
          await register(data);
        } catch (err) {
          setError(err instanceof Error ? err.message : "Registration failed");
        } finally {
          setIsLoading(false);
        }
      };

      return (
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-4">
          {error && (
            <div className="p-3 text-sm text-red-500 bg-red-50 border border-red-200 rounded-md">
              {error}
            </div>
          )}

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="name">Tu nombre</Label>
              <Input
                id="name"
                placeholder="Dr. Juan Perez"
                {...form.register("name")}
              />
              {form.formState.errors.name && (
                <p className="text-sm text-red-500">{form.formState.errors.name.message}</p>
              )}
            </div>

            <div className="space-y-2">
              <Label htmlFor="email">Email</Label>
              <Input
                id="email"
                type="email"
                placeholder="correo@clinica.com"
                {...form.register("email")}
              />
              {form.formState.errors.email && (
                <p className="text-sm text-red-500">{form.formState.errors.email.message}</p>
              )}
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="password">Password</Label>
            <Input
              id="password"
              type="password"
              placeholder="Minimo 8 caracteres, letra y numero"
              {...form.register("password")}
            />
            {form.formState.errors.password && (
              <p className="text-sm text-red-500">{form.formState.errors.password.message}</p>
            )}
          </div>

          <div className="border-t pt-4 mt-4">
            <h3 className="font-medium mb-3">Datos de tu clinica</h3>

            <div className="space-y-4">
              <div className="space-y-2">
                <Label htmlFor="clinicName">Nombre de la clinica</Label>
                <Input
                  id="clinicName"
                  placeholder="Clinica Dental Sonrisa"
                  {...form.register("clinicName")}
                />
                {form.formState.errors.clinicName && (
                  <p className="text-sm text-red-500">{form.formState.errors.clinicName.message}</p>
                )}
              </div>

              <div className="space-y-2">
                <Label htmlFor="clinicPhone">Telefono de la clinica</Label>
                <Input
                  id="clinicPhone"
                  placeholder="+56 9 1234 5678"
                  {...form.register("clinicPhone")}
                />
                {form.formState.errors.clinicPhone && (
                  <p className="text-sm text-red-500">{form.formState.errors.clinicPhone.message}</p>
                )}
              </div>
            </div>
          </div>

          <Button type="submit" className="w-full" disabled={isLoading}>
            {isLoading ? "Creando cuenta..." : "Crear cuenta"}
          </Button>

          <p className="text-center text-sm text-muted-foreground">
            Ya tienes cuenta?{" "}
            <Link href="/login" className="text-primary hover:underline">
              Inicia sesion
            </Link>
          </p>
        </form>
      );
    }
    ```

    4. Create src/app/(auth)/register/page.tsx:
    ```typescript
    import { AuthCard } from "@/components/auth/auth-card";
    import { RegisterForm } from "@/components/auth/register-form";

    export default function RegisterPage() {
      return (
        <AuthCard
          title="Crear Cuenta"
          description="Registra tu clinica dental en el sistema"
        >
          <RegisterForm />
        </AuthCard>
      );
    }
    ```

    5. Install additional shadcn component for checkbox:
    ```bash
    npx shadcn@latest add checkbox
    ```

    6. Install react-hook-form and zod resolver:
    ```bash
    npm install react-hook-form @hookform/resolvers
    ```
  </action>
  <verify>
    - npm run dev starts without errors
    - /login page renders with email, password, remember me, forgot password link
    - /register page renders with all fields (name, email, password, clinic name, clinic phone)
    - Form validation shows errors for invalid input
  </verify>
  <done>
    Login and register pages with forms, validation, and Convex integration complete
  </done>
</task>

<task type="auto">
  <name>Task 3: Build email verification and password reset pages</name>
  <files>
    src/app/(auth)/verify-email/page.tsx
    src/app/(auth)/forgot-password/page.tsx
    src/app/(auth)/reset-password/page.tsx
    src/components/auth/verify-email-form.tsx
    src/components/auth/forgot-password-form.tsx
    src/components/auth/reset-password-form.tsx
  </files>
  <action>
    1. Create src/components/auth/verify-email-form.tsx:
    ```typescript
    "use client";

    import { useState } from "react";
    import { useForm } from "react-hook-form";
    import { zodResolver } from "@hookform/resolvers/zod";
    import { Button } from "@/components/ui/button";
    import { Input } from "@/components/ui/input";
    import { Label } from "@/components/ui/label";
    import { verifyEmailSchema, type VerifyEmailFormData } from "@/lib/validations/auth";
    import { useAuth } from "@/hooks/use-auth";

    export function VerifyEmailForm() {
      const [error, setError] = useState<string | null>(null);
      const [isLoading, setIsLoading] = useState(false);
      const [resendCooldown, setResendCooldown] = useState(0);
      const { verifyEmail, createVerificationCode } = useAuth();

      const form = useForm<VerifyEmailFormData>({
        resolver: zodResolver(verifyEmailSchema),
        defaultValues: {
          code: "",
        },
      });

      const onSubmit = async (data: VerifyEmailFormData) => {
        setError(null);
        setIsLoading(true);
        try {
          await verifyEmail(data.code);
        } catch (err) {
          setError(err instanceof Error ? err.message : "Verification failed");
        } finally {
          setIsLoading(false);
        }
      };

      const handleResend = async () => {
        try {
          await createVerificationCode({ type: "email" });
          setResendCooldown(60);
          const interval = setInterval(() => {
            setResendCooldown((prev) => {
              if (prev <= 1) {
                clearInterval(interval);
                return 0;
              }
              return prev - 1;
            });
          }, 1000);
        } catch (err) {
          setError(err instanceof Error ? err.message : "Failed to resend code");
        }
      };

      return (
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-4">
          {error && (
            <div className="p-3 text-sm text-red-500 bg-red-50 border border-red-200 rounded-md">
              {error}
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="code">Codigo de verificacion</Label>
            <Input
              id="code"
              placeholder="123456"
              maxLength={6}
              className="text-center text-2xl tracking-widest"
              {...form.register("code")}
            />
            {form.formState.errors.code && (
              <p className="text-sm text-red-500">{form.formState.errors.code.message}</p>
            )}
            <p className="text-sm text-muted-foreground">
              Ingresa el codigo de 6 digitos enviado a tu email
            </p>
          </div>

          <Button type="submit" className="w-full" disabled={isLoading}>
            {isLoading ? "Verificando..." : "Verificar email"}
          </Button>

          <div className="text-center">
            <Button
              type="button"
              variant="link"
              onClick={handleResend}
              disabled={resendCooldown > 0}
            >
              {resendCooldown > 0
                ? `Reenviar codigo en ${resendCooldown}s`
                : "Reenviar codigo"}
            </Button>
          </div>
        </form>
      );
    }
    ```

    2. Create src/app/(auth)/verify-email/page.tsx:
    ```typescript
    import { AuthCard } from "@/components/auth/auth-card";
    import { VerifyEmailForm } from "@/components/auth/verify-email-form";

    export default function VerifyEmailPage() {
      return (
        <AuthCard
          title="Verifica tu Email"
          description="Hemos enviado un codigo de verificacion a tu correo"
        >
          <VerifyEmailForm />
        </AuthCard>
      );
    }
    ```

    3. Create src/components/auth/forgot-password-form.tsx:
    ```typescript
    "use client";

    import { useState } from "react";
    import { useForm } from "react-hook-form";
    import { zodResolver } from "@hookform/resolvers/zod";
    import Link from "next/link";
    import { useRouter } from "next/navigation";
    import { Button } from "@/components/ui/button";
    import { Input } from "@/components/ui/input";
    import { Label } from "@/components/ui/label";
    import { forgotPasswordSchema, type ForgotPasswordFormData } from "@/lib/validations/auth";
    import { useMutation } from "convex/react";
    import { api } from "../../../convex/_generated/api";

    export function ForgotPasswordForm() {
      const [error, setError] = useState<string | null>(null);
      const [success, setSuccess] = useState(false);
      const [isLoading, setIsLoading] = useState(false);
      const router = useRouter();
      const createResetCode = useMutation(api.emails.createResetCodeByEmail);

      const form = useForm<ForgotPasswordFormData>({
        resolver: zodResolver(forgotPasswordSchema),
        defaultValues: {
          email: "",
        },
      });

      const onSubmit = async (data: ForgotPasswordFormData) => {
        setError(null);
        setIsLoading(true);
        try {
          await createResetCode({ email: data.email });
          setSuccess(true);
        } catch (err) {
          setError(err instanceof Error ? err.message : "Failed to send reset code");
        } finally {
          setIsLoading(false);
        }
      };

      if (success) {
        return (
          <div className="space-y-4">
            <div className="p-4 bg-green-50 border border-green-200 rounded-md">
              <p className="text-sm text-green-700">
                Si el email existe en nuestro sistema, recibiras un codigo de recuperacion.
              </p>
            </div>
            <Button
              className="w-full"
              onClick={() => router.push("/reset-password")}
            >
              Tengo el codigo
            </Button>
            <p className="text-center text-sm text-muted-foreground">
              <Link href="/login" className="text-primary hover:underline">
                Volver al login
              </Link>
            </p>
          </div>
        );
      }

      return (
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-4">
          {error && (
            <div className="p-3 text-sm text-red-500 bg-red-50 border border-red-200 rounded-md">
              {error}
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="email">Email</Label>
            <Input
              id="email"
              type="email"
              placeholder="correo@clinica.com"
              {...form.register("email")}
            />
            {form.formState.errors.email && (
              <p className="text-sm text-red-500">{form.formState.errors.email.message}</p>
            )}
          </div>

          <Button type="submit" className="w-full" disabled={isLoading}>
            {isLoading ? "Enviando..." : "Enviar codigo de recuperacion"}
          </Button>

          <p className="text-center text-sm text-muted-foreground">
            <Link href="/login" className="text-primary hover:underline">
              Volver al login
            </Link>
          </p>
        </form>
      );
    }
    ```

    4. Create src/app/(auth)/forgot-password/page.tsx:
    ```typescript
    import { AuthCard } from "@/components/auth/auth-card";
    import { ForgotPasswordForm } from "@/components/auth/forgot-password-form";

    export default function ForgotPasswordPage() {
      return (
        <AuthCard
          title="Recuperar Password"
          description="Ingresa tu email para recibir un codigo de recuperacion"
        >
          <ForgotPasswordForm />
        </AuthCard>
      );
    }
    ```

    5. Create src/components/auth/reset-password-form.tsx:
    ```typescript
    "use client";

    import { useState } from "react";
    import { useForm } from "react-hook-form";
    import { zodResolver } from "@hookform/resolvers/zod";
    import Link from "next/link";
    import { useRouter } from "next/navigation";
    import { Button } from "@/components/ui/button";
    import { Input } from "@/components/ui/input";
    import { Label } from "@/components/ui/label";
    import { resetPasswordSchema, type ResetPasswordFormData } from "@/lib/validations/auth";

    export function ResetPasswordForm() {
      const [error, setError] = useState<string | null>(null);
      const [isLoading, setIsLoading] = useState(false);
      const router = useRouter();

      const form = useForm<ResetPasswordFormData>({
        resolver: zodResolver(resetPasswordSchema),
        defaultValues: {
          code: "",
          password: "",
          confirmPassword: "",
        },
      });

      const onSubmit = async (data: ResetPasswordFormData) => {
        setError(null);
        setIsLoading(true);
        try {
          // TODO: Implement password reset mutation
          // await resetPassword({ code: data.code, password: data.password });
          router.push("/login");
        } catch (err) {
          setError(err instanceof Error ? err.message : "Password reset failed");
        } finally {
          setIsLoading(false);
        }
      };

      return (
        <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-4">
          {error && (
            <div className="p-3 text-sm text-red-500 bg-red-50 border border-red-200 rounded-md">
              {error}
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="code">Codigo de recuperacion</Label>
            <Input
              id="code"
              placeholder="123456"
              maxLength={6}
              className="text-center text-2xl tracking-widest"
              {...form.register("code")}
            />
            {form.formState.errors.code && (
              <p className="text-sm text-red-500">{form.formState.errors.code.message}</p>
            )}
          </div>

          <div className="space-y-2">
            <Label htmlFor="password">Nueva password</Label>
            <Input
              id="password"
              type="password"
              placeholder="Minimo 8 caracteres, letra y numero"
              {...form.register("password")}
            />
            {form.formState.errors.password && (
              <p className="text-sm text-red-500">{form.formState.errors.password.message}</p>
            )}
          </div>

          <div className="space-y-2">
            <Label htmlFor="confirmPassword">Confirmar password</Label>
            <Input
              id="confirmPassword"
              type="password"
              {...form.register("confirmPassword")}
            />
            {form.formState.errors.confirmPassword && (
              <p className="text-sm text-red-500">{form.formState.errors.confirmPassword.message}</p>
            )}
          </div>

          <Button type="submit" className="w-full" disabled={isLoading}>
            {isLoading ? "Cambiando..." : "Cambiar password"}
          </Button>

          <p className="text-center text-sm text-muted-foreground">
            <Link href="/login" className="text-primary hover:underline">
              Volver al login
            </Link>
          </p>
        </form>
      );
    }
    ```

    6. Create src/app/(auth)/reset-password/page.tsx:
    ```typescript
    import { AuthCard } from "@/components/auth/auth-card";
    import { ResetPasswordForm } from "@/components/auth/reset-password-form";

    export default function ResetPasswordPage() {
      return (
        <AuthCard
          title="Nueva Password"
          description="Ingresa el codigo de recuperacion y tu nueva password"
        >
          <ResetPasswordForm />
        </AuthCard>
      );
    }
    ```
  </action>
  <verify>
    - /verify-email page renders with 6-digit code input
    - /forgot-password page renders with email input
    - /reset-password page renders with code + new password inputs
    - Resend button has 60-second cooldown
  </verify>
  <done>
    Email verification, forgot password, and reset password flows complete with forms and validation
  </done>
</task>

</tasks>

<verification>
1. Navigate to /login - see login form with all elements
2. Navigate to /register - see registration form with clinic fields
3. Navigate to /verify-email - see 6-digit code input
4. Navigate to /forgot-password - see email input and submit
5. Navigate to /reset-password - see code + password inputs
6. Test form validation on each page (empty fields, invalid email, weak password)
</verification>

<success_criteria>
- Login form with email, password, remember me, forgot password link
- Register form with name, email, password, clinic name, clinic phone
- Email verification page with 6-digit code input and resend button
- Password recovery flow (forgot -> reset) complete
- All forms have client-side validation
- Forms connected to Convex mutations via useAuth hook
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
